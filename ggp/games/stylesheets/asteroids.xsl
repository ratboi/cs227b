<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:template match="/"><html><head><title><xsl:value-of select="match/@id"/></title><script type='text/javascript'>var step = 1;var steps = <xsl:value-of select="count(match/herstory/state)"/>*1;function showstate (stepnum) {var oldstate = document.getElementById(step);  var newstate = document.getElementById(stepnum);  var counter = document.getElementById('stepcount');  var leftcell = document.getElementById('left');  var rightcell = document.getElementById('right');  var oldstep = document.getElementById('step' + step);  var newstep = document.getElementById('step' + stepnum);  step=stepnum;  oldstate.style.display = 'none';  newstate.style.display = '';  if (stepnum == 1) {leftcell.src = '/docserver/gamemaster/images/greyleft.gif'}     else {leftcell.src = '/docserver/gamemaster/images/blackleft.gif'};  counter.innerHTML = step;  if (stepnum == steps) {rightcell.src = '/docserver/gamemaster/images/greyright.gif'}     else {rightcell.src = '/docserver/gamemaster/images/blackright.gif'}  if (oldstep) {oldstep.style.backgroundColor = '#ffff99'};  if (newstep) {newstep.style.backgroundColor = '#ffffcc'}}</script></head><body leftmargin='0' topmargin='0' marginwidth='0' marginheight='0' bgcolor='#ffffcc'><center><table width='800' height='65' cellspacing='0' cellpadding='0' border='0'><tr> <td><img src='/docserver/gamemaster/images/ggp.gif' width='480' height='65' border='0'/></td><td width='100%' align='center' valign='center'><b><xsl:value-of select="match/@id"/><br/><xsl:value-of select="match/game"/><br/>Startclock: <xsl:value-of select="match/startclock"/>Playclock: <xsl:value-of select="match/playclock"/>Steplimit: <xsl:value-of select="match/steplimit"/></b></td></tr></table><table width='800' cellpadding='0' cellspacing='0' border='0'><tr><td width='100%' height='2' bgcolor='#336699'></td></tr></table></center><div style='margin-left:10px; margin-right:10px; margin-top:10px; margin-bottom:10px'><center><table width='800'><tr><td width='50%' align='center' valign='top'><xsl:for-each select="match/herstory/state">  <div>    <xsl:attribute name='id'><xsl:value-of select="stepnum"/></xsl:attribute>    <xsl:attribute name='style'>display:none</xsl:attribute>		<!-- Game specific stuff goes here -->		<style type="text/css" media="all">			#cell			{				width:  16px;				height: 16px;				float:	left;				z-index:-1;				border: 2px solid #FFC;				background-color: #CCCCCC;			}			#planet			{				width:  16px;				height: 16px;				background-color: #99CCFF;			}		</style>				<div id="main" style="position:relative; width:400px; height:400px">			<!-- Draw Board -->			<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>											<div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/><div id="cell"/>			<!-- Draw Planet -->			<div id="planet" style="position:absolute; top:302px; left:282px;"/>					<!-- Grab Ship Data -->			<xsl:variable name="xShip" select="2 + (fact[relation='x']/argument[1] - 1) * 20"/>			<xsl:variable name="yShip" select="2 + (20 - fact[relation='y']/argument[1]) * 20"/>							<!-- Draw ship -->							<div>				<xsl:attribute name="style">					<xsl:value-of select="concat('position:absolute; z-index:10; left:', $xShip ,'px; top:', $yShip ,'px; height:16px; width:16px; background-color: #000000')"/>				</xsl:attribute>				<p></p>			</div>						<!-- Draw north-south velocity -->							<xsl:variable name="deltaY" select="fact[relation='north-speed']/argument[1]"/>											<xsl:if test="$deltaY &gt; 0">				<xsl:variable name="yVectorLen" select="$deltaY * 20"/>								<xsl:variable name="yVectorX"   select="$xShip + 7"/>				<xsl:variable name="yVectorY"   select="$yShip - ($deltaY - 1) * 20 - 11"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $yVectorX ,'px; top:', $yVectorY ,'px; height:', $yVectorLen, 'px; width:2px; background-color: #333333')"/>					</xsl:attribute>					<p></p>				</div>			</xsl:if>				<xsl:if test="$deltaY &lt; 0">				<xsl:variable name="yVectorLen" select="$deltaY * -20"/>								<xsl:variable name="yVectorX"   select="$xShip + 7"/>				<xsl:variable name="yVectorY"   select="$yShip + 9"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $yVectorX ,'px; top:', $yVectorY ,'px; height:', $yVectorLen, 'px; width:2px; background-color: #333333')"/>					</xsl:attribute>										<p></p>					</div>			</xsl:if>				<!-- Draw east-west velocity -->							<xsl:variable name="deltaX" select="fact[relation='east-speed']/argument[1]"/>											<xsl:if test="$deltaX &gt; 0">				<xsl:variable name="xVectorLen" select="$deltaX * 20"/>								<xsl:variable name="xVectorX"   select="$xShip + 9"/>				<xsl:variable name="xVectorY"   select="$yShip + 7"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $xVectorX ,'px; top:', $xVectorY ,'px; width:', $xVectorLen, 'px; height:2px; background-color: #333333')"/>					</xsl:attribute>					<p></p>						</div>			</xsl:if>				<xsl:if test="$deltaX &lt; 0">				<xsl:variable name="xVectorLen" select="$deltaX * -20"/>								<xsl:variable name="xVectorX"   select="$xShip + ($deltaX + 1) * 20 - 11"/>				<xsl:variable name="xVectorY"   select="$yShip + 7"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $xVectorX ,'px; top:', $xVectorY ,'px; width:', $xVectorLen, 'px; height:2px; background-color: #333333')"/>					</xsl:attribute>					<p></p>						</div>			</xsl:if>							<!-- Draw heading -->			<xsl:if test="fact[relation='heading']/argument[1]='north'">				<xsl:variable name="xHeading" select="$xShip + 7"/>				<xsl:variable name="yHeading" select="$yShip - 11"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $xHeading ,'px; top:', $yHeading ,'px; height:20px; width:2px; background-color: #FF0000')"/>					</xsl:attribute>					<p></p>						</div>			</xsl:if>			<xsl:if test="fact[relation='heading']/argument[1]='south'">				<xsl:variable name="xHeading" select="$xShip + 7"/>				<xsl:variable name="yHeading" select="$yShip + 10"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $xHeading ,'px; top:', $yHeading ,'px; height:20px; width:2px; background-color: #FF0000')"/>					</xsl:attribute>					<p></p>						</div>			</xsl:if>			<xsl:if test="fact[relation='heading']/argument[1]='east'">				<xsl:variable name="xHeading" select="$xShip + 9"/>				<xsl:variable name="yHeading" select="$yShip + 7"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $xHeading ,'px; top:', $yHeading ,'px; height:2px; width:20px; background-color: #FF0000')"/>					</xsl:attribute>					<p></p>						</div>			</xsl:if>			<xsl:if test="fact[relation='heading']/argument[1]='west'">				<xsl:variable name="xHeading" select="$xShip - 11"/>				<xsl:variable name="yHeading" select="$yShip + 7"/>				<div>											<xsl:attribute name="style">						<xsl:value-of select="concat('position:absolute; left:', $xHeading ,'px; top:', $yHeading ,'px; height:2px; width:20px; background-color: #FF0000')"/>					</xsl:attribute>					<p></p>						</div>			</xsl:if>					</div>					<!-- Game specific stuff goes here -->  </div></xsl:for-each><table><tr><td valign='center'><img id='left' src='/docserver/gamemaster/images/greyleft.gif' border='0' onClick='showstate(Math.max(step-1,1))'/></td><td valign='center'>Step <span id='stepcount'>1</span></td><td valign='center'><img id='right' src='/docserver/gamemaster/images/blackright.gif' border='0' onClick='showstate(Math.min(step+1,steps))'/></td></tr></table></td><td width='50%' align='center' valign='top'><table cellpadding='3' cellspacing='0' border='1' bgcolor='#ffffcc'>  <tr bgcolor='#ffff99'>    <th>Step Number</th>    <xsl:for-each select="match/player">      <th><xsl:value-of select="."/></th>    </xsl:for-each>  </tr>  <xsl:for-each select="match/history/move">    <tr>        <td style='cursor:pointer' align='center' bgcolor='#ffff99'>          <xsl:attribute name='id'>step<xsl:value-of select="./stepnum"/></xsl:attribute>          <xsl:attribute name='onClick'>            <xsl:value-of select="concat('showstate(',stepnum,')')"/>          </xsl:attribute>          <xsl:value-of select="stepnum"/>        </td>      <xsl:for-each select="action">        <td>        <xsl:choose>          <xsl:when test = "function">            (<xsl:value-of select="function"/>             <xsl:for-each select="argument">&#160;<xsl:value-of select="."/></xsl:for-each>)<br/>          </xsl:when>          <xsl:otherwise>            <xsl:value-of select="."/>          </xsl:otherwise>        </xsl:choose>        </td>      </xsl:for-each>    </tr>  </xsl:for-each>  <xsl:if test="match/rewards">    <tr bgcolor='#ffff99'>      <xsl:if test="count(match/herstory/state) = '1'">        <td align='center' bgcolor='#ffffcc'>          <xsl:attribute name='id'>step<xsl:value-of select="count(match/herstory/state)"/></xsl:attribute>          Final        </td>      </xsl:if>      <xsl:if test="count(match/herstory/state) != '1'">        <td style='cursor:pointer' align='center' bgcolor='#ffff99'>          <xsl:attribute name='id'>step<xsl:value-of select="count(match/herstory/state)"/></xsl:attribute>          <xsl:attribute name='onClick'>            <xsl:value-of select="concat('showstate(&quot;',count(match/herstory/state),'&quot;)')"/>          </xsl:attribute>          Final        </td>      </xsl:if>      <xsl:for-each select="match/rewards/reward">	<td align='center'><xsl:value-of select="."/></td>      </xsl:for-each>    </tr>  </xsl:if></table></td></tr></table></center></div><script type='text/javascript'>showstate(1)</script><br/><center><table width='800' cellpadding='0' cellspacing='0' border='0'><tr><td width='100%' height='2' bgcolor='#336699'></td></tr></table><div style='font-size:14px'>Match information provided by <a href='http://games.stanford.edu'>Gamemaster</a>.</div></center></body></html></xsl:template></xsl:stylesheet>